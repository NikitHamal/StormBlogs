<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StormBlogs - Read Article</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const urlParams = new URLSearchParams(window.location.search);
            const postId = urlParams.get('id');
            
            fetch('posts.json')
                .then(response => response.json())
                .then(posts => {
                    if (!Array.isArray(posts) || posts.length === 0) {
                        document.getElementById("article-content").innerHTML = "<p style='text-align:center;'>Article not found.</p>";
                        return;
                    }
                    
                    const post = posts.find(post => post.id == postId);
                    
                    if (post) {
                        document.getElementById("article-title").textContent = post.title;
                        document.getElementById("article-category").textContent = post.category;
                        document.getElementById("article-time").textContent = formatTimeAgo(Date.now() - post.timestamp);
                        document.getElementById("article-body").innerHTML = post.body;
                    } else {
                        document.getElementById("article-content").innerHTML = "<p style='text-align:center;'>Article not found.</p>";
                    }
                })
                .catch(error => console.error("Error loading posts:", error));
        });

        function formatTimeAgo(milliseconds) {
            const seconds = Math.floor(milliseconds / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            const weeks = Math.floor(days / 7);
            const months = Math.floor(days / 30);
            const years = Math.floor(days / 365);
            
            if (years > 0) return `${years} year${years > 1 ? 's' : ''}`;
            if (months > 0) return `${months} month${months > 1 ? 's' : ''}`;
            if (weeks > 0) return `${weeks} week${weeks > 1 ? 's' : ''}`;
            if (days > 0) return `${days} day${days > 1 ? 's' : ''}`;
            if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''}`;
            if (minutes > 0) return `${minutes} minute${minutes > 1 ? 's' : ''}`;
            return `${seconds} second${seconds > 1 ? 's' : ''}`;
        }
    </script>
</head>
<body style="font-family: 'Poppins', serif; margin: 0; padding: 0; line-height: 1.6; color: #333; scroll-behavior: smooth;">

<header>
    <div style="display: flex; align-items: center; justify-content: space-between;">
        <div style="display: flex; align-items: center; margin:32px; margin-top:36px;">
            <img onclick="location.href='home.html';" src="logo.png" alt="Logo" style="margin-right: 4px; height:26px; width: 26px; cursor:pointer;">
            <h4 onclick="location.href='home.html';" style="color: #111111; margin: 0; cursor:pointer;">/Storm Blogs</h4>
        </div>
    </div>
</header>

<main style="margin: 32px; margin-top:0px; background-color: #fff; padding: 16px; padding-top:0px;">
    <div id="article-content">
        <p id="article-category" style="color:black; margin-bottom: 8px; background-color:#D7AFFF; border-radius:32px; padding:4px 16px; width:fit-content;"></p>
        <h1 id="article-title" style="margin-bottom: 16px;"></h1>

        <div id="article-body" style="font-size:18px; font-weight:500; line-height: 1.8;"></div>
        
        <p id="article-time" style="color: #aaa; margin-bottom: 24px;"></p>

    </div>
</main>

</body>
</html>
